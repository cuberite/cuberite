language: cpp
cache:
  ccache: true
  directories:
    # Store ctest cost data
    - Testing

# Use Linux by default
os: linux
dist: bionic

# Install newer SeeMake on Linux
addons:
  snaps:
    - name: cmake
      confinement: classic
      channel: latest

jobs:
  include:
    # ARM workers are the slowest. Having these first in the build matrix makes travis faster overall.
    - name: "Clang 6.0 - Debug"
      arch: arm64
      compiler: clang
      before_install: &use-cmake
        - export PATH=/snap/bin/:${PATH}
      env: *Debug

# Do not let CMake find ccache wrappers
# we use CMAKE_CXX_COMPILER_LAUNCHER for ccache support
before_script:
  - export PATH=$(echo "$PATH" | sed -e 's/:\/usr\/lib\/ccache//')

# Run the build and tests
script: ./travisbuild.sh

notifications:
  email:
    on_success: change
    on_failure: always

branches:
  only:
    - master
