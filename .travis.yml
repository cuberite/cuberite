language: cpp

sudo: required
dist: trusty

compiler:
- clang
- gcc

cache:
  ccache

addons:
  apt:
    packages:

before_install:
  - |
    if [ "$CC" = "clang" ]; then
      export CCACHE_CPP2=yes;
      sudo ln -s ../../bin/ccache /usr/lib/ccache/clang;
      sudo ln -s ../../bin/ccache /usr/lib/ccache/clang++;
    fi

script:
  ./CIbuild.sh

env:
  - TRAVIS_CUBERITE_BUILD_TYPE=RELEASE CUBERITE_PATH=./Cuberite
  - TRAVIS_CUBERITE_BUILD_TYPE=DEBUG   CUBERITE_PATH=./Cuberite_debug

notifications:
  email:
    on_success: change
    on_failure: always

branches:
  only:
    - coverity_scan
    - master

