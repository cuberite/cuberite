version: 1.0.{build}
image:
  - Ubuntu
configuration: Release
clone_depth: 50
platform:
  - x86
  - x64

before_build:
- cmd: echo %TIME%
- cmd: git submodule update --init
- cmd: echo %TIME%
- cmd: cmake -G "Visual Studio 15 2017" -DSELF_TEST=1 -DBUILD_TOOLS=1 .
- cmd: echo %TIME%

- sh: git submodule update --init
- sh: cmake . -DNO_NATIVE_OPTIMIZATION=1 -DCMAKE_BUILD_TYPE=RELEASE
- sh: make -j`nproc`

artifacts:
  - path: Server
    name: Cuberite
    type: zip
