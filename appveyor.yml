version: 1.0.{build}
image: Visual Studio 2017
configuration: Release
clone_depth: 50

environment:
  matrix:
  - job_name: Windows-x86
  - job_name: Windows-x64

install:
- ps: $env:CUBERITE_BUILD_SERIES_NAME = "Windows"
- ps: $env:CUBERITE_BUILD_ID = "$env:APPVEYOR_BUILD_NUMBER"
- ps: $env:CUBERITE_BUILD_DATETIME = "$env:TIME"
- echo %CUBERITE_BUILD_SERIES_NAME%
- echo %CUBERITE_BUILD_ID%
- echo %CUBERITE_BUILD_DATETIME%

for:
-
  matrix:
    only:
      - job_name: Windows-x86

  before_build:
  - echo %TIME%
  - git submodule update --init
  - echo %TIME%
  - cmake -G "Visual Studio 15 2017" -DSELF_TEST=1 -DBUILD_TOOLS=1 .
  - echo %TIME%

-
  matrix:
    only:
      - job_name: Windows-x64

  before_build:
  - echo %TIME%
  - git submodule update --init
  - echo %TIME%
  - cmake -G "Visual Studio 15 2017 Win64" -DSELF_TEST=1 -DBUILD_TOOLS=1 .
  - echo %TIME%

build:
  project: Cuberite.sln
  parallel: true
  verbosity: minimal

artifacts:
  - path: Server
    name: Cuberite
    type: zip
